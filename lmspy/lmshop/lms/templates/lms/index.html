{% extends "lms/std_page.html" %}
{% load static %}
{% load custom_tags %}

{% block title %}
{{page_title}}
{% endblock %}

{% block page_header %}
  {% include "lms/include/ad-block.html" with static_image="img/bkg-001.jpg" %}
{% endblock %}

{% block page_content %}
  {% include "lms/include/catalogue-type-A.html" with products=products title="Каталог" favorites=favorites order=order pages=product_pages kind="pd" %}
  {% include "lms/include/catalogue-type-A.html" with products=bestsellers favorites=favorites title="Бестселлеры" order=order pages=bestseller_pages kind="bs" %}
{% endblock %}

{% block footer_header %}
  {% include "lms/include/ad-block.html" with static_image="img/bkg-002.jpg" %}
{% endblock %}

{% block DOM_ready_script %}
{% endblock %}

{% block javascript %}
heart_click = (input, url) => {
  url = url.replace(/\/\d\/$/, `/${input.checked?1:0}/`);
  fetch(url, {'method': 'POST', headers: {'X-CSRFToken': csrftoken}}).then(response => response.json()).then(answer => {
    let selector = `input[type="checkbox"][data-ppk="${answer.ppk}"]`;
    let inputs = document.querySelectorAll(selector);
    inputs.forEach((a,b,c) => {
      a.checked = answer.like;
    });
  });
}
{% endblock %}
